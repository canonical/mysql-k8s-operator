{"uid":"e02244da757ea53","name":"test_kill_db_process","fullName":"tests.integration.high_availability.test_self_healing#test_kill_db_process","historyId":"cf89d21b60cb6eab4b436c583b096289","time":{"start":1711502862026,"stop":1711502899831,"duration":37805},"description":"Test to send a SIGKILL to the primary db process and ensure that the cluster self heals.","descriptionHtml":"<p>Test to send a SIGKILL to the primary db process and ensure that the cluster self heals.</p>\n","status":"broken","statusMessage":"juju.errors.JujuAppError: App in error: mysql-k8s","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/test_self_healing.py\", line 53, in test_kill_db_process\n    mysql_application_name, _ = await high_availability_test_setup(ops_test)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/high_availability_helpers.py\", line 299, in high_availability_test_setup\n    await relate_mysql_and_application(ops_test, mysql_application_name, application_name)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/high_availability_helpers.py\", line 230, in relate_mysql_and_application\n    await ops_test.model.wait_for_idle(\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2751, in wait_for_idle\n    _raise_for_status(errors, \"error\")\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2657, in _raise_for_status\n    raise error_type(\"{}{} in {}: {}\".format(\njuju.errors.JujuAppError: App in error: mysql-k8s","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop","time":{"start":1711502841105,"stop":1711502841106,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1711502841106,"stop":1711502841106,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1711502841106,"stop":1711502841400,"duration":294},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"continuous_writes","time":{"start":1711502862026,"stop":1711502862026,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1711502862026,"stop":1711502862026,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test to send a SIGKILL to the primary db process and ensure that the cluster self heals.","status":"broken","statusMessage":"juju.errors.JujuAppError: App in error: mysql-k8s","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/test_self_healing.py\", line 53, in test_kill_db_process\n    mysql_application_name, _ = await high_availability_test_setup(ops_test)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/high_availability_helpers.py\", line 299, in high_availability_test_setup\n    await relate_mysql_and_application(ops_test, mysql_application_name, application_name)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/high_availability/high_availability_helpers.py\", line 230, in relate_mysql_and_application\n    await ops_test.model.wait_for_idle(\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2751, in wait_for_idle\n    _raise_for_status(errors, \"error\")\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2657, in _raise_for_status\n    raise error_type(\"{}{} in {}: {}\".format(\njuju.errors.JujuAppError: App in error: mysql-k8s","steps":[],"attachments":[{"uid":"e5c7228541ba336b","name":"log","source":"e5c7228541ba336b.txt","type":"text/plain","size":411}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1711502899833,"stop":1711502899833,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1711502899856,"stop":1711502901400,"duration":1544},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1711502901401,"stop":1711502901401,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1711502901401,"stop":1711502901401,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1711502901401,"stop":1711502901402,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration.high_availability"},{"name":"suite","value":"test_self_healing"},{"name":"host","value":"fv-az1487-968"},{"name":"thread","value":"12655-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.high_availability.test_self_healing"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":3,"broken":6,"skipped":0,"passed":43,"unknown":0,"total":52},"items":[{"uid":"acb078d9c2d37444","reportUrl":"../1756//#testresult/acb078d9c2d37444","status":"passed","time":{"start":1711416619688,"stop":1711416726225,"duration":106537}},{"uid":"fec9d7f4ee3308e7","reportUrl":"../1750//#testresult/fec9d7f4ee3308e7","status":"broken","statusDetails":"juju.errors.JujuAppError: App in error: mysql-k8s","time":{"start":1711330132775,"stop":1711330174046,"duration":41271}},{"uid":"b9b51170cdc4fc7c","reportUrl":"../1749//#testresult/b9b51170cdc4fc7c","status":"passed","time":{"start":1711243840715,"stop":1711243929963,"duration":89248}},{"uid":"1caf10395c45e80b","reportUrl":"../1748//#testresult/1caf10395c45e80b","status":"passed","time":{"start":1711157378658,"stop":1711157467813,"duration":89155}},{"uid":"fb3b304cba39ab9","reportUrl":"../1745//#testresult/fb3b304cba39ab9","status":"passed","time":{"start":1711071017459,"stop":1711071106638,"duration":89179}},{"uid":"27b7597d4b4bfca8","reportUrl":"../1740//#testresult/27b7597d4b4bfca8","status":"passed","time":{"start":1710984634957,"stop":1710984725171,"duration":90214}},{"uid":"c45e7952784013d0","reportUrl":"../1736//#testresult/c45e7952784013d0","status":"passed","time":{"start":1710898220768,"stop":1710898310919,"duration":90151}},{"uid":"20cadb8abbf20467","reportUrl":"../1730//#testresult/20cadb8abbf20467","status":"passed","time":{"start":1710811786651,"stop":1710811876928,"duration":90277}},{"uid":"554dd5b204c33e1","reportUrl":"../1725//#testresult/554dd5b204c33e1","status":"passed","time":{"start":1710725417486,"stop":1710725507502,"duration":90016}},{"uid":"4401296bbd112bcf","reportUrl":"../1724//#testresult/4401296bbd112bcf","status":"passed","time":{"start":1710639082639,"stop":1710639172780,"duration":90141}},{"uid":"7972869dadf8d52d","reportUrl":"../1723//#testresult/7972869dadf8d52d","status":"passed","time":{"start":1710552514228,"stop":1710552605488,"duration":91260}},{"uid":"c65858c707f4bae","reportUrl":"../1720//#testresult/c65858c707f4bae","status":"passed","time":{"start":1710466223330,"stop":1710466313414,"duration":90084}},{"uid":"61c6b2f13aebb77b","reportUrl":"../1714//#testresult/61c6b2f13aebb77b","status":"passed","time":{"start":1710379790811,"stop":1710379878944,"duration":88133}},{"uid":"ffa4bbfe1cb27451","reportUrl":"../1710//#testresult/ffa4bbfe1cb27451","status":"passed","time":{"start":1710293478513,"stop":1710293569672,"duration":91159}},{"uid":"fd5b32c3916766c9","reportUrl":"../1705//#testresult/fd5b32c3916766c9","status":"passed","time":{"start":1710207018298,"stop":1710207108520,"duration":90222}},{"uid":"4922b57a4935f92e","reportUrl":"../1701//#testresult/4922b57a4935f92e","status":"failed","statusDetails":"AssertionError: The mysql application is not fully online after sending SIGKILL to primary\nassert False","time":{"start":1710120635140,"stop":1710120965437,"duration":330297}},{"uid":"62ed0d68681311ad","reportUrl":"../1700//#testresult/62ed0d68681311ad","status":"passed","time":{"start":1710034279780,"stop":1710034369860,"duration":90080}},{"uid":"39f9f5bf58f113f5","reportUrl":"../1699//#testresult/39f9f5bf58f113f5","status":"passed","time":{"start":1709947697285,"stop":1709947787305,"duration":90020}},{"uid":"89f05095fe62575b","reportUrl":"../1694//#testresult/89f05095fe62575b","status":"passed","time":{"start":1709861357728,"stop":1709861448822,"duration":91094}},{"uid":"a3a49f8ac0508f3e","reportUrl":"../1686//#testresult/a3a49f8ac0508f3e","status":"passed","time":{"start":1709774509628,"stop":1709774599813,"duration":90185}}]},"tags":["asyncio","abort_on_fail","group(1)"]},"source":"e02244da757ea53.json","parameterValues":[]}