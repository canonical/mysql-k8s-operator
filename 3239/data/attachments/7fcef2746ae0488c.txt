[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:359 Deploying a new mysql cluster
[32mINFO    [0m juju.model:model.py:2284 Deploying local:mysql-k8s-1
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [executing] maintenance: Initialising mysqld
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [idle] active: Primary
[33mWARNING [0m juju.model:model.py:1666 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [idle] active: Primary
  s3-integrator/0 [executing] active: 
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:378 Rotating all mysql credentials
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:395 Syncing credentials
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [idle] active: Primary
  s3-integrator/0 [idle] active: 
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:409 Waiting for blocked application status with another cluster S3 repository
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:417 Restoring backup_id='2025-09-15T01:56:55Z'
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:422 Ensuring that the pre-backup inserted value exists in database, while post-backup inserted value does not
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:436 Inserting value after restore
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:445 Ensuring that pre-backup and post-restore values exist in the database
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:456 Scaling mysql application to 3 units
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s (waiting for exactly 3 units, current : 1)
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [executing] active: Primary
  another-mysql-k8s/2 [executing] maintenance: Initialising mysqld
  another-mysql-k8s/1 [executing] maintenance: Initialising mysqld
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [executing] active: Primary
  another-mysql-k8s/2 [executing] waiting: waiting to get cluster primary from peers
  another-mysql-k8s/1 [executing] waiting: waiting to get cluster primary from peers
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  another-mysql-k8s/0 [idle] active: Primary
  another-mysql-k8s/2 [executing] maintenance: joining the cluster
  another-mysql-k8s/1 [idle] active: 
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:464 Ensuring inserted values before backup and after restore exist on all units
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:482 Waiting for blocked application status after restore
[32mINFO    [0m pytest_operator.plugin:plugin.py:790 Model status:

Model    Controller          Cloud/Region        Version  SLA          Timestamp
testing  concierge-microk8s  microk8s/localhost  3.6.9    unsupported  02:09:00Z

App                Version                  Status   Scale  Charm          Channel        Rev  Address         Exposed  Message
another-mysql-k8s  8.0.42-0ubuntu0.22.04.2  blocked      3  mysql-k8s                       1  10.152.183.59   no       Move restored cluster to another S3 repository
mysql-k8s                                   blocked      3  mysql-k8s                       0  10.152.183.188  no       Move restored cluster to another S3 repository
s3-integrator                               active       1  s3-integrator  latest/stable  145  10.152.183.109  no       

Unit                  Workload  Agent      Address      Ports  Message
another-mysql-k8s/0*  active    executing  10.1.242.82         Primary
another-mysql-k8s/1   active    executing  10.1.242.86         
another-mysql-k8s/2   active    executing  10.1.242.85         
mysql-k8s/0*          active    executing  10.1.242.75         Primary
mysql-k8s/1           active    executing  10.1.242.80         
mysql-k8s/2           active    executing  10.1.242.79         
s3-integrator/0*      active    idle       10.1.242.78         

[32mINFO    [0m pytest_operator.plugin:plugin.py:796 Juju error logs:

unit-mysql-k8s-2: 01:57:19 ERROR unit.mysql-k8s/2.juju-log Failed to execute mysql-shell command
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-mysql-k8s-2/charm/src/mysql_k8s_helpers.py", line 714, in _run_mysqlsh_script
    stdout, _ = process.wait_output()
  File "/var/lib/juju/agents/unit-mysql-k8s-2/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1771, in wait_output
    raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
ops.pebble.ExecError: non-zero exit code 1 executing ['/usr/bin/mysqlsh', '--passwords-from-stdin', '--uri=serverconfig@mysql-k8s-1.mysql-k8s-endpoints.testing.svc.cluster.local.:33062', '--python', '--verbose=0', '-c', 'shell.options.set(\'useWizards\', False)\nprint(\'###\')\nsession.run_sql("UPDATE mysql.juju_units_operations SET executor=\'mysql-k8s-2\', status=\'in-progress\' WHERE task=\'unit-teardown\' AND executor=\'\';")\nacquired_lock = session.run_sql("SELECT count(*) FROM mysql.juju_units_operations WHERE task=\'unit-teardown\' AND executor=\'mysql-k8s-2\';").fetch_one()[0]\nprint(f\'<ACQUIRED_LOCK>{acquired_lock}</ACQUIRED_LOCK>\')'], stdout="\x1b[1mPlease provide the password for 'serverconfig@mysql-k8s-1.mysql-k8s-endpoints.testing.svc.cluster.local.:33062': \x1b[0m###\n", stderr='Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nTraceback (most recent call last):\n  File "<string>", line 3, in <module>\nmysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement\n'

[32mINFO    [0m pytest_operator.plugin:plugin.py:862 Forgetting main...
[32mINFO    [0m integration.test_backup_ceph:test_backup_ceph.py:133 Cleaning backups from buckets