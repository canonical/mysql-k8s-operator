[32mINFO    [0m jubilant:_juju.py:308 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:68 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes
[32mINFO    [0m root:test_async_replication_upgrade.py:70 Starting continuous writes
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json mysql-test-app/0 start-continuous-writes
[32mINFO    [0m jubilant:_juju.py:308 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:263 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:267 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpqh58z9km
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpufey3iy3
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmpkgb9p2p3
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:272 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp2a1lr9sl
[32mINFO    [0m root:test_async_replication_upgrade.py:276 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:282 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpwoz0tzf3
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmp2ldt5lz7
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju model-config --model testing update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpjjoag0ws
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmp_ppc1zf_
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmppln49ctn
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:285 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:308 cli: juju refresh --model testing db1 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:291 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:297 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:307 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:313 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp0_g9x8va
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmp64vw0_m8
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju model-config --model testing update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpl478czuo
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmp0ml32rc8
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmpka20l57o
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:263 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:267 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmp1owuromg
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpv5jqjehn
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmp0jvmxol7
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:272 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmprsfvxu3l
[32mINFO    [0m root:test_async_replication_upgrade.py:276 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:282 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpvw61j611
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpy3855epb
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju model-config --model testing-other update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpegcm6r0i
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpf9xsxo6a
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmpid29kf1h
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:285 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:308 cli: juju refresh --model testing-other db2 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:291 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:297 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.68:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:307 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:313 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp_eskzu1p
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmp300pklh1
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju model-config --model testing-other update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpenec1wla
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmp35x3bxl8
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmp2tdc_jzl
[32mINFO    [0m jubilant:_juju.py:308 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:75 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:308 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes