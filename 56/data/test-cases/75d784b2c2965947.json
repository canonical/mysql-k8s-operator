{"uid":"75d784b2c2965947","name":"test_data_replication","fullName":"tests.integration.integration.high_availability.test_async_replication#test_data_replication","historyId":"6396c2f90d43e7f6c1e0aa98f3404932","time":{"start":1767751120160,"stop":1767751147190,"duration":27030},"description":"Test to write to primary, and read the same data back from replicas.","descriptionHtml":"<p>Test to write to primary, and read the same data back from replicas.</p>\n","status":"broken","statusMessage":"mysql.connector.errors.ProgrammingError: 1049 (42000): Unknown database 'continuous_writes'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/connection_cext.py\", line 706, in cmd_query\n    self._cmysql.query(\n_mysql_connector.MySQLInterfaceError: Unknown database 'continuous_writes'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_async_replication.py\", line 216, in test_data_replication\n    results = get_mysql_max_written_values(first_model, second_model)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_async_replication.py\", line 411, in get_mysql_max_written_values\n    unit_max_value = get_mysql_max_written_value(model_2, MYSQL_APP_2, unit_name)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/helpers_ha.py\", line 453, in get_mysql_max_written_value\n    output = execute_queries_on_unit(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/helpers.py\", line 177, in execute_queries_on_unit\n    cursor.execute(query)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/cursor_cext.py\", line 357, in execute\n    result = self._connection.cmd_query(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/opentelemetry/context_propagation.py\", line 97, in wrapper\n    return method(cnx, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/connection_cext.py\", line 714, in cmd_query\n    raise get_mysql_exception(\nmysql.connector.errors.ProgrammingError: 1049 (42000): Unknown database 'continuous_writes'","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"juju","time":{"start":1767750939467,"stop":1767750939749,"duration":282},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model","time":{"start":1767750939750,"stop":1767750939750,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model","time":{"start":1767750939750,"stop":1767750939976,"duration":226},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1767751111522,"stop":1767751111522,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"continuous_writes","time":{"start":1767751111522,"stop":1767751120160,"duration":8638},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test to write to primary, and read the same data back from replicas.","status":"broken","statusMessage":"mysql.connector.errors.ProgrammingError: 1049 (42000): Unknown database 'continuous_writes'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/connection_cext.py\", line 706, in cmd_query\n    self._cmysql.query(\n_mysql_connector.MySQLInterfaceError: Unknown database 'continuous_writes'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_async_replication.py\", line 216, in test_data_replication\n    results = get_mysql_max_written_values(first_model, second_model)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_async_replication.py\", line 411, in get_mysql_max_written_values\n    unit_max_value = get_mysql_max_written_value(model_2, MYSQL_APP_2, unit_name)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/helpers_ha.py\", line 453, in get_mysql_max_written_value\n    output = execute_queries_on_unit(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/helpers.py\", line 177, in execute_queries_on_unit\n    cursor.execute(query)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/cursor_cext.py\", line 357, in execute\n    result = self._connection.cmd_query(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/opentelemetry/context_propagation.py\", line 97, in wrapper\n    return method(cnx, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/mysql/connector/connection_cext.py\", line 714, in cmd_query\n    raise get_mysql_exception(\nmysql.connector.errors.ProgrammingError: 1049 (42000): Unknown database 'continuous_writes'","steps":[],"attachments":[{"uid":"9d829652f7501388","name":"log","source":"9d829652f7501388.txt","type":"text/plain","size":2633}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"continuous_writes::0","time":{"start":1767751147194,"stop":1767751148032,"duration":838},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1767751148033,"stop":1767751148033,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model::0","time":{"start":1767751172210,"stop":1767751293450,"duration":121240},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model::0","time":{"start":1767751293450,"stop":1767751293450,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"juju::0","time":{"start":1767751293451,"stop":1767751293709,"duration":258},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"@pytest.mark.skipif(False, reason='Requires juju 3+')"},{"name":"parentSuite","value":"tests.integration.integration.high_availability"},{"name":"suite","value":"test_async_replication"},{"name":"host","value":"runnervmh13bl"},{"name":"thread","value":"19373-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.integration.high_availability.test_async_replication"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"e30427a810c34050","status":"unknown","time":{}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":5,"skipped":0,"passed":26,"unknown":0,"total":31},"items":[{"uid":"ef8b8113a0874a20","reportUrl":"../55//#testresult/ef8b8113a0874a20","status":"broken","statusDetails":"TimeoutError: timed out waiting for action, stderr:\nRunning operation 13 with 1 task\n  - task 14 on unit-db1-2\n\nWaiting for task 14...\nERROR timed out waiting for results from: unit db1/2","time":{"start":1767664952526,"stop":1767665024459,"duration":71933}},{"uid":"cb68a8e2576e07f1","reportUrl":"../54//#testresult/cb68a8e2576e07f1","status":"passed","time":{"start":1767578707661,"stop":1767578729601,"duration":21940}},{"uid":"6fb62f17ea38fe51","reportUrl":"../53//#testresult/6fb62f17ea38fe51","status":"broken","statusDetails":"TimeoutError: timed out waiting for action, stderr:\nRunning operation 9 with 1 task\n  - task 10 on unit-db1-0\n\nWaiting for task 10...\nERROR timed out waiting for results from: unit db1/0","time":{"start":1767493282886,"stop":1767493350679,"duration":67793}},{"uid":"dddc4e696351f317","reportUrl":"../52//#testresult/dddc4e696351f317","status":"passed","time":{"start":1767404992809,"stop":1767405014655,"duration":21846}},{"uid":"204211c068887b40","reportUrl":"../51//#testresult/204211c068887b40","status":"passed","time":{"start":1767318875594,"stop":1767318900258,"duration":24664}},{"uid":"e30267876394f01d","reportUrl":"../50//#testresult/e30267876394f01d","status":"passed","time":{"start":1767232240861,"stop":1767232261061,"duration":20200}},{"uid":"451b212e9147d8bd","reportUrl":"../49//#testresult/451b212e9147d8bd","status":"passed","time":{"start":1767146080298,"stop":1767146099752,"duration":19454}},{"uid":"824cc75ba737bf68","reportUrl":"../48//#testresult/824cc75ba737bf68","status":"broken","statusDetails":"mysql.connector.errors.DatabaseError: 2003 (HY000): Can't connect to MySQL server on '10.1.206.84:3306' (111)","time":{"start":1767059475394,"stop":1767059490729,"duration":15335}},{"uid":"bc8dccd05ee4549d","reportUrl":"../47//#testresult/bc8dccd05ee4549d","status":"passed","time":{"start":1766973160312,"stop":1766973179812,"duration":19500}},{"uid":"b4949c4214175fa0","reportUrl":"../46//#testresult/b4949c4214175fa0","status":"passed","time":{"start":1766886548857,"stop":1766886568620,"duration":19763}},{"uid":"6476627c93aa7c0","reportUrl":"../45//#testresult/6476627c93aa7c0","status":"passed","time":{"start":1766800655566,"stop":1766800674977,"duration":19411}},{"uid":"cbe5149d0b5da157","reportUrl":"../44//#testresult/cbe5149d0b5da157","status":"passed","time":{"start":1766713545936,"stop":1766713567433,"duration":21497}},{"uid":"fbfd0ed922df88de","reportUrl":"../43//#testresult/fbfd0ed922df88de","status":"passed","time":{"start":1766627690477,"stop":1766627713951,"duration":23474}},{"uid":"2a8bdafea3ed1a73","reportUrl":"../42//#testresult/2a8bdafea3ed1a73","status":"passed","time":{"start":1766540999023,"stop":1766541019953,"duration":20930}},{"uid":"2ec348401f56af60","reportUrl":"../41//#testresult/2ec348401f56af60","status":"passed","time":{"start":1766454511031,"stop":1766454530495,"duration":19464}},{"uid":"325a9dfc18fb755","reportUrl":"../40//#testresult/325a9dfc18fb755","status":"passed","time":{"start":1766367996336,"stop":1766368032909,"duration":36573}},{"uid":"b031c17394b0d11f","reportUrl":"../39//#testresult/b031c17394b0d11f","status":"passed","time":{"start":1766281967980,"stop":1766281988769,"duration":20789}},{"uid":"8e9a32acad3cbb57","reportUrl":"../38//#testresult/8e9a32acad3cbb57","status":"passed","time":{"start":1766195287041,"stop":1766195308780,"duration":21739}},{"uid":"7a98d7e392cab24","reportUrl":"../37//#testresult/7a98d7e392cab24","status":"passed","time":{"start":1766110406229,"stop":1766110425822,"duration":19593}},{"uid":"7e611c17de2daf60","reportUrl":"../36//#testresult/7e611c17de2daf60","status":"passed","time":{"start":1766023155821,"stop":1766023175148,"duration":19327}}]},"tags":["abort_on_fail","@pytest.mark.skipif(False, reason='Requires juju 3+')"]},"source":"75d784b2c2965947.json","parameterValues":[]}