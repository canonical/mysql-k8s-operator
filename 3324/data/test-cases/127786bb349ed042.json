{"uid":"127786bb349ed042","name":"test_upgrade_from_edge","fullName":"tests.integration.high_availability.test_async_replication_upgrade#test_upgrade_from_edge","historyId":"d79fc3a887248243c4518ea12eaedfd1","time":{"start":1760147268075,"stop":1760147569496,"duration":301421},"description":"Upgrade the two MySQL clusters.","descriptionHtml":"<p>Upgrade the two MySQL clusters.</p>\n","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 212, in test_upgrade_from_edge\n    run_pre_upgrade_checks(model_2, MYSQL_APP_2)\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 263, in run_pre_upgrade_checks\n    task = juju.run(unit=app_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"charm","time":{"start":1760146844072,"stop":1760146844072,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"juju","time":{"start":1760146844072,"stop":1760146844350,"duration":278},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model","time":{"start":1760146844350,"stop":1760146844350,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model","time":{"start":1760146844350,"stop":1760146844606,"duration":256},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1760147259067,"stop":1760147259067,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"continuous_writes","time":{"start":1760147259067,"stop":1760147268074,"duration":9007},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Upgrade the two MySQL clusters.","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 212, in test_upgrade_from_edge\n    run_pre_upgrade_checks(model_2, MYSQL_APP_2)\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 263, in run_pre_upgrade_checks\n    task = juju.run(unit=app_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","steps":[],"attachments":[{"uid":"64aa1a0b272b2076","name":"log","source":"64aa1a0b272b2076.txt","type":"text/plain","size":7118}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"continuous_writes::0","time":{"start":1760147569501,"stop":1760147570740,"duration":1239},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1760147570741,"stop":1760147570741,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model::0","time":{"start":1760147608636,"stop":1760147730656,"duration":122020},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model::0","time":{"start":1760147730656,"stop":1760147730656,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"juju::0","time":{"start":1760147730657,"stop":1760147730933,"duration":276},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"@pytest.mark.skipif(False, reason='Requires juju 3+')"},{"name":"parentSuite","value":"tests.integration.high_availability"},{"name":"suite","value":"test_async_replication_upgrade"},{"name":"host","value":"runnervmwhb2z"},{"name":"thread","value":"18685-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.high_availability.test_async_replication_upgrade"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"3e14d5f82ee34c71","status":"unknown","time":{}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":5,"skipped":0,"passed":11,"unknown":0,"total":16},"items":[{"uid":"8d34bafb58c79587","reportUrl":"../3323//#testresult/8d34bafb58c79587","status":"passed","time":{"start":1760061788373,"stop":1760062416943,"duration":628570}},{"uid":"8f3b558738481c96","reportUrl":"../3322//#testresult/8f3b558738481c96","status":"broken","statusDetails":"jubilant._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","time":{"start":1759975387337,"stop":1759975683745,"duration":296408}},{"uid":"8e98f2bdce7ef00d","reportUrl":"../3318//#testresult/8e98f2bdce7ef00d","status":"passed","time":{"start":1759889058852,"stop":1759889765675,"duration":706823}},{"uid":"f6a8e2aae2ebe16f","reportUrl":"../3311//#testresult/f6a8e2aae2ebe16f","status":"passed","time":{"start":1759802198014,"stop":1759802893310,"duration":695296}},{"uid":"acbf68cbd87cec7a","reportUrl":"../3305//#testresult/acbf68cbd87cec7a","status":"broken","statusDetails":"TimeoutError: timed out waiting for action, stderr:\nRunning operation 7 with 1 task\n  - task 8 on unit-db1-0\n\nWaiting for task 8...\nERROR timed out waiting for results from: unit db1/0","time":{"start":1759719325052,"stop":1759719386273,"duration":61221}},{"uid":"3b3e191388fe1048","reportUrl":"../3304//#testresult/3b3e191388fe1048","status":"passed","time":{"start":1759633196931,"stop":1759633925181,"duration":728250}},{"uid":"c8a48ba43f9f8ab4","reportUrl":"../3303//#testresult/c8a48ba43f9f8ab4","status":"passed","time":{"start":1759543110037,"stop":1759543872638,"duration":762601}},{"uid":"a44384eb65b42c7e","reportUrl":"../3302//#testresult/a44384eb65b42c7e","status":"passed","time":{"start":1759456995475,"stop":1759457707128,"duration":711653}},{"uid":"c73a822333c3c0e8","reportUrl":"../3299//#testresult/c73a822333c3c0e8","status":"passed","time":{"start":1759370796234,"stop":1759371568067,"duration":771833}},{"uid":"5056edc7e32e7978","reportUrl":"../3296//#testresult/5056edc7e32e7978","status":"passed","time":{"start":1759284550225,"stop":1759285221679,"duration":671454}},{"uid":"a53936c7df78ca34","reportUrl":"../3288//#testresult/a53936c7df78ca34","status":"broken","statusDetails":"jubilant._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","time":{"start":1759198033115,"stop":1759198365805,"duration":332690}},{"uid":"6dc055683c5a31ab","reportUrl":"../3287//#testresult/6dc055683c5a31ab","status":"passed","time":{"start":1759110122442,"stop":1759110828733,"duration":706291}},{"uid":"4f1a037d68da3973","reportUrl":"../3286//#testresult/4f1a037d68da3973","status":"broken","statusDetails":"jubilant._task.TaskError: task error: Task 8: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","time":{"start":1759026641646,"stop":1759026645985,"duration":4339}},{"uid":"b35d48228ef9ffb","reportUrl":"../3285//#testresult/b35d48228ef9ffb","status":"passed","time":{"start":1758937227663,"stop":1758937822559,"duration":594896}},{"uid":"ccb45f12119a72d4","reportUrl":"../3283//#testresult/ccb45f12119a72d4","status":"passed","time":{"start":1758853751566,"stop":1758854395215,"duration":643649}}]},"tags":["abort_on_fail","@pytest.mark.skipif(False, reason='Requires juju 3+')"]},"source":"127786bb349ed042.json","parameterValues":[]}