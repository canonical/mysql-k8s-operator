[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:67 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes
[32mINFO    [0m root:test_async_replication_upgrade.py:69 Starting continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 start-continuous-writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:262 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:266 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpo6mvlw2b
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpz7v4xti0
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmp4iopwfjk
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:271 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpw4abuet3
[32mINFO    [0m root:test_async_replication_upgrade.py:275 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:281 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpqv32jqpv
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmplp9on_pj
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju model-config --model testing update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpy19gr_r4
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpc_nyjgvy
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmpj9dxb7gc
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:284 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju refresh --model testing db1 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:290 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:296 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:306 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:312 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp1gf_o8x2
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpcrpc3bgv
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju model-config --model testing update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmp8fv09y_7
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpmw30g_hi
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmpg94pe_ar
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:262 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:266 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmp3avyp_5e
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpv3fhaodj
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmp41epzx5f
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:271 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp9h7kq8mx
[32mINFO    [0m root:test_async_replication_upgrade.py:275 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:281 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpvkis55y5
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmp_47moe9x
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju model-config --model testing-other update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmplj3d51jq
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmp8psu5iga
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmp8f9fx3bd
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:284 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju refresh --model testing-other db2 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:290 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:296 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.50:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:306 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:312 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpxo3eudzp
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpj49bka9l
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju model-config --model testing-other update-status-hook-interval=15s
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmp5z1m1m8u
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpf4i54fmk
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmpweoqywe4
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:74 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes