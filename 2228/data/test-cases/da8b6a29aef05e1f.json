{"uid":"da8b6a29aef05e1f","name":"test_log_rotation","fullName":"tests.integration.test_charm#test_log_rotation","historyId":"fba48f3f67c94d8a859b39529a060883","time":{"start":1724722739455,"stop":1724722743874,"duration":4419},"description":"Test the log rotation of text files.","descriptionHtml":"<p>Test the log rotation of text files.</p>\n","status":"failed","statusMessage":"AssertionError: ❌ files other than log files exist ['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log']\nassert 5 == 3\n +  where 5 = len(['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log'])\n +  and   3 = len(['error.log', 'general.log', 'audit.log'])","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/test_charm.py\", line 392, in test_log_rotation\n    assert len(ls_la_output) == len(\nAssertionError: ❌ files other than log files exist ['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log']\nassert 5 == 3\n +  where 5 = len(['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log'])\n +  and   3 = len(['error.log', 'general.log', 'audit.log'])","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"event_loop","time":{"start":1724722224699,"stop":1724722224699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1724722224700,"stop":1724722224982,"duration":282},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1724722224700,"stop":1724722224700,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1724722739455,"stop":1724722739455,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test the log rotation of text files.","status":"failed","statusMessage":"AssertionError: ❌ files other than log files exist ['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log']\nassert 5 == 3\n +  where 5 = len(['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log'])\n +  and   3 = len(['error.log', 'general.log', 'audit.log'])","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/test_charm.py\", line 392, in test_log_rotation\n    assert len(ls_la_output) == len(\nAssertionError: ❌ files other than log files exist ['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log']\nassert 5 == 3\n +  where 5 = len(['drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_error', 'drwxrwx--- 2 mysql mysql  4096 Aug 27 01:39 archive_general', '-rw------- 1  1001 584789   19 Aug 27 01:39 audit.log', '-rw------- 1  1001 584789   19 Aug 27 01:39 error.log', '-rw------- 1  1001 584789   21 Aug 27 01:39 general.log'])\n +  and   3 = len(['error.log', 'general.log', 'audit.log'])","steps":[],"attachments":[{"uid":"3b94b2362e7d1608","name":"log","source":"3b94b2362e7d1608.txt","type":"text/plain","size":1461}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"ops_test::finalizer","time":{"start":1724722743972,"stop":1724722744330,"duration":358},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1724722743972,"stop":1724722743972,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1724722744331,"stop":1724722744331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1724722744331,"stop":1724722744331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1724722744331,"stop":1724722744332,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_charm"},{"name":"host","value":"fv-az1116-203"},{"name":"thread","value":"12895-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_charm"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"76c78612b0573e77","status":"unknown","time":{}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":0,"skipped":17,"passed":176,"unknown":4,"total":199},"items":[{"uid":"e316eb772cf26441","reportUrl":"../2221//#testresult/e316eb772cf26441","status":"passed","time":{"start":1724549966871,"stop":1724549974475,"duration":7604}},{"uid":"b04af4d571f40f07","reportUrl":"../2213//#testresult/b04af4d571f40f07","status":"passed","time":{"start":1724377132491,"stop":1724377140515,"duration":8024}},{"uid":"b0c54ddaf115ff32","reportUrl":"../2205//#testresult/b0c54ddaf115ff32","status":"passed","time":{"start":1724290744189,"stop":1724290752124,"duration":7935}},{"uid":"83a92f1ce3845f74","reportUrl":"../2198//#testresult/83a92f1ce3845f74","status":"passed","time":{"start":1724204366569,"stop":1724204374154,"duration":7585}},{"uid":"5d8304a0cc5bd45f","reportUrl":"../2194//#testresult/5d8304a0cc5bd45f","status":"passed","time":{"start":1724118011627,"stop":1724118019595,"duration":7968}},{"uid":"95df6445072a7910","reportUrl":"../2191//#testresult/95df6445072a7910","status":"passed","time":{"start":1724031531875,"stop":1724031539284,"duration":7409}},{"uid":"f85dfaa2a4081cb6","reportUrl":"../2190//#testresult/f85dfaa2a4081cb6","status":"passed","time":{"start":1723945182708,"stop":1723945190356,"duration":7648}},{"uid":"ee39bbab7c1fe1a1","reportUrl":"../2189//#testresult/ee39bbab7c1fe1a1","status":"passed","time":{"start":1723858735971,"stop":1723858744337,"duration":8366}},{"uid":"1741bf323297f984","reportUrl":"../2186//#testresult/1741bf323297f984","status":"passed","time":{"start":1723772341439,"stop":1723772349523,"duration":8084}},{"uid":"6de2ec274a0c4457","reportUrl":"../2183//#testresult/6de2ec274a0c4457","status":"passed","time":{"start":1723685876887,"stop":1723685885594,"duration":8707}},{"uid":"a2392aa66cf3c47e","reportUrl":"../2178//#testresult/a2392aa66cf3c47e","status":"passed","time":{"start":1723600009679,"stop":1723600017120,"duration":7441}},{"uid":"fae959992ba2d298","reportUrl":"../2173//#testresult/fae959992ba2d298","status":"passed","time":{"start":1723513586785,"stop":1723513594501,"duration":7716}},{"uid":"c49fdfedbda7403c","reportUrl":"../2169//#testresult/c49fdfedbda7403c","status":"passed","time":{"start":1723426925851,"stop":1723426933280,"duration":7429}},{"uid":"f03f7880b5451ec2","reportUrl":"../2168//#testresult/f03f7880b5451ec2","status":"passed","time":{"start":1723340820762,"stop":1723340829013,"duration":8251}},{"uid":"c8bd912b5cd2cb8b","reportUrl":"../2167//#testresult/c8bd912b5cd2cb8b","status":"passed","time":{"start":1723254547623,"stop":1723254555106,"duration":7483}},{"uid":"cf83022418e31397","reportUrl":"../2165//#testresult/cf83022418e31397","status":"unknown","time":{}},{"uid":"b37ea8b494254a59","reportUrl":"../2152//#testresult/b37ea8b494254a59","status":"passed","time":{"start":1722995307737,"stop":1722995314181,"duration":6444}},{"uid":"85166393a1c556d5","reportUrl":"../2146//#testresult/85166393a1c556d5","status":"passed","time":{"start":1722908755376,"stop":1722908762734,"duration":7358}},{"uid":"5c5a491c4df9715a","reportUrl":"../2142//#testresult/5c5a491c4df9715a","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1722822991246,"stop":1722822991246,"duration":0}},{"uid":"c4583bb1697c04cd","reportUrl":"../2140//#testresult/c4583bb1697c04cd","status":"skipped","statusDetails":"XFAIL reason: aborted\n\n_pytest.outcomes.XFailed: aborted","time":{"start":1722736780436,"stop":1722736780436,"duration":0}}]},"tags":["asyncio","abort_on_fail","group(1)"]},"source":"da8b6a29aef05e1f.json","parameterValues":[]}