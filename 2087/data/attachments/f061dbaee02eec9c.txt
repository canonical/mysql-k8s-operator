[32mINFO    [0m integration.high_availability.conftest:conftest.py:26 Clearing continuous writes
[32mINFO    [0m integration.high_availability.conftest:conftest.py:28 Starting continuous writes
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: DELETE https://10.1.1.190:16443/api/v1/namespaces/test/pods/mysql-k8s-2 "HTTP/1.1 200 OK"
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  mysql-k8s/0 [executing] active: 
  mysql-k8s/1 [executing] active: 
  mysql-k8s/2 [idle] maintenance: offline
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  mysql-k8s/0 [idle] active: 
  mysql-k8s/1 [idle] active: 
  mysql-k8s/2 [idle] maintenance: offline
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  mysql-k8s/0 [executing] active: 
  mysql-k8s/1 [executing] active: Primary
  mysql-k8s/2 [executing] active: 
[32mINFO    [0m juju.model:model.py:2971 Waiting for model:
  mysql-k8s/0 [idle] active: 
  mysql-k8s/1 [idle] active: Primary
  mysql-k8s/2 [idle] active:
[32mINFO    [0m integration.high_availability.conftest:conftest.py:33 Clearing continuous writes
[32mINFO    [0m pytest_operator.plugin:plugin.py:790 Model status:

Model  Controller          Cloud/Region        Version  SLA          Timestamp
test   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:46:23Z

App             Version                  Status  Scale  Charm           Channel      Rev  Address         Exposed  Message
mysql-k8s       8.0.37-0ubuntu0.22.04.3  active      3  mysql-k8s                      0  10.152.183.68   no       
mysql-test-app  0.0.2                    active      1  mysql-test-app  latest/edge   46  10.152.183.100  no       Last written value=18390

Unit               Workload  Agent  Address      Ports  Message
mysql-k8s/0        active    idle   10.1.115.75         
mysql-k8s/1        active    idle   10.1.115.77         Primary
mysql-k8s/2*       active    idle   10.1.115.83         
mysql-test-app/0*  active    idle   10.1.115.78         Last written value=18390

[32mINFO    [0m pytest_operator.plugin:plugin.py:796 Juju error logs:

unit-mysql-test-app-0: 02:39:40 ERROR unit.mysql-test-app/0.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/mysql/connector/connection_cext.py", line 291, in _open_connection
    self._cmysql.connect(**cnx_kwargs)
_mysql_connector.MySQLInterfaceError: Access denied for user 'relation-4_c119a17662394cf'@'mysql-test-app-0.mysql-test-app-endpoints.test.svc.cluster.local' (using password: YES)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/./src/charm.py", line 455, in <module>
    main(MySQLTestApplication)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/main.py", line 548, in main
    manager.run()
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/main.py", line 527, in run
    self._emit()
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/main.py", line 516, in _emit
    _emit_charm_event(self.charm, self.dispatcher.event_name)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/main.py", line 147, in _emit_charm_event
    event_to_emit.emit(*args, **kwargs)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/framework.py", line 348, in emit
    framework._emit(event)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/framework.py", line 860, in _emit
    self._reemit(event_path)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/ops/framework.py", line 950, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/./src/charm.py", line 306, in _on_clear_continuous_writes_action
    with MySQLConnector(self._database_config) as cursor:
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/src/connector.py", line 42, in __enter__
    self.connection = mysql.connector.connect(**self.config)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/mysql/connector/pooling.py", line 293, in connect
    return CMySQLConnection(*args, **kwargs)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/mysql/connector/connection_cext.py", line 120, in __init__
    self.connect(**kwargs)
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/mysql/connector/abstracts.py", line 1181, in connect
    self._open_connection()
  File "/var/lib/juju/agents/unit-mysql-test-app-0/charm/venv/mysql/connector/connection_cext.py", line 296, in _open_connection
    raise get_mysql_exception(
mysql.connector.errors.ProgrammingError: 1045 (28000): Access denied for user 'relation-4_c119a17662394cf'@'mysql-test-app-0.mysql-test-app-endpoints.test.svc.cluster.local' (using password: YES)
unit-mysql-k8s-2: 02:43:17 ERROR unit.mysql-k8s/2.juju-log Cluster upgrade failed, ensure pre-upgrade checks are ran first.

[32mINFO    [0m pytest_operator.plugin:plugin.py:862 Forgetting main...