[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:67 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes
[32mINFO    [0m root:test_async_replication_upgrade.py:69 Starting continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 start-continuous-writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju version --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:262 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:266 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpqjzap8gd
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpgp0rf393
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmp68mi7ltq
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:271 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpytvff_qy
[32mINFO    [0m root:test_async_replication_upgrade.py:275 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:281 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmprqlhayd0
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmps106pwjv
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpsvkucq9k
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpup5_9f2l
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmphi9gamrg
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:284 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju refresh --model testing db1 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:290 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:296 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing/statefulsets/db1 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:306 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:312 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpb_vzjlqn
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmpq_y9jgu7
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpsck2lcax
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpyf1d3pqe
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpblugj0t2
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpw80swnhp
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpn3kntmcb
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpl06bo52v
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpxcw3_7lh
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpsknjpff6
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/0 get-password --params /root/snap/juju/common/tmpu7doqxl_
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/1 get-password --params /root/snap/juju/common/tmp0vwobwpj
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json db1/2 get-password --params /root/snap/juju/common/tmpq35r7on7
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:262 Run pre-upgrade-check action
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 pre-upgrade-check
[32mINFO    [0m root:test_async_replication_upgrade.py:266 Assert slow shutdown is enabled
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpf2jtjsmm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpqpuq2m6o
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmpnfp3kfbf
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:271 Assert primary is set to leader
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmp_33mnj4n
[32mINFO    [0m root:test_async_replication_upgrade.py:275 Assert partition is set to 2
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:281 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmppt_h6s5o
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpb4lusz7h
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpachzv1dd
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpzbtn1y5n
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmpqset62v8
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:284 Refresh the charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju refresh --model testing-other db2 --path ./mysql-k8s_ubuntu@22.04-amd64.charm
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:290 Wait for upgrade to complete on first upgrading unit
[32mINFO    [0m root:test_async_replication_upgrade.py:296 Resume upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 resume-upgrade
[32mINFO    [0m httpx:_client.py:1026 HTTP Request: GET https://10.1.0.151:16443/apis/apps/v1/namespaces/testing-other/statefulsets/db2 "HTTP/1.1 200 OK"
[32mINFO    [0m root:test_async_replication_upgrade.py:306 Wait for upgrade to complete
[32mINFO    [0m root:test_async_replication_upgrade.py:312 Ensure continuous writes are incrementing
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-cluster-status --wait 300s --params /root/snap/juju/common/tmpo17oybrl
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmpwnk36ind
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/0 get-password --params /root/snap/juju/common/tmpj8lm0j3e
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/1 get-password --params /root/snap/juju/common/tmptkswqx_m
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing-other --format json db2/2 get-password --params /root/snap/juju/common/tmp72u5pxxg
[32mINFO    [0m jubilant:_juju.py:316 cli: juju status --model testing-other --format json
[32mINFO    [0m root:test_async_replication_upgrade.py:74 Clearing continuous writes
[32mINFO    [0m jubilant:_juju.py:316 cli: juju run --model testing --format json mysql-test-app/0 clear-continuous-writes