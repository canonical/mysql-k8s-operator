{"uid":"b19cc6413905f379","name":"test_build_and_deploy","fullName":"tests.integration.relations.test_database#test_build_and_deploy","historyId":"bdfc2af63e333d3ba27ec17869a51075","time":{"start":1716859843273,"stop":1716859866035,"duration":22762},"description":"Build the charm and deploy 3 units to ensure a cluster is formed.","descriptionHtml":"<p>Build the charm and deploy 3 units to ensure a cluster is formed.</p>\n","status":"broken","statusMessage":"juju.errors.JujuAppError: App in error: mysql-k8s","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/relations/test_database.py\", line 68, in test_build_and_deploy\n    await asyncio.gather(\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2751, in wait_for_idle\n    _raise_for_status(errors, \"error\")\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2657, in _raise_for_status\n    raise error_type(\"{}{} in {}: {}\".format(\njuju.errors.JujuAppError: App in error: mysql-k8s","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"tmp_path_factory","time":{"start":1716859843047,"stop":1716859843047,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop","time":{"start":1716859843047,"stop":1716859843047,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1716859843048,"stop":1716859843273,"duration":225},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1716859843273,"stop":1716859843273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Build the charm and deploy 3 units to ensure a cluster is formed.","status":"broken","statusMessage":"juju.errors.JujuAppError: App in error: mysql-k8s","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/tests/integration/relations/test_database.py\", line 68, in test_build_and_deploy\n    await asyncio.gather(\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2751, in wait_for_idle\n    _raise_for_status(errors, \"error\")\n  File \"/home/runner/work/mysql-k8s-operator/mysql-k8s-operator/.tox/integration/lib/python3.10/site-packages/juju/model.py\", line 2657, in _raise_for_status\n    raise error_type(\"{}{} in {}: {}\".format(\njuju.errors.JujuAppError: App in error: mysql-k8s","steps":[],"attachments":[{"uid":"f2c8f3914929c889","name":"log","source":"f2c8f3914929c889.txt","type":"text/plain","size":694}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1716859866038,"stop":1716859866038,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1716859866047,"stop":1716859873273,"duration":7226},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1716859873276,"stop":1716859873276,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1716859873276,"stop":1716859873276,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1716859873276,"stop":1716859873276,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"skip_if_deployed"},{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration.relations"},{"name":"suite","value":"test_database"},{"name":"host","value":"fv-az573-544"},{"name":"thread","value":"12166-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.relations.test_database"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":12,"skipped":0,"passed":104,"unknown":0,"total":116},"items":[{"uid":"b3b3ab87b762efbc","reportUrl":"../1904//#testresult/b3b3ab87b762efbc","status":"passed","time":{"start":1716773261086,"stop":1716773390621,"duration":129535}},{"uid":"99e749017448e3d7","reportUrl":"../1903//#testresult/99e749017448e3d7","status":"passed","time":{"start":1716686888950,"stop":1716687016719,"duration":127769}},{"uid":"66adb99b69ac0338","reportUrl":"../1902//#testresult/66adb99b69ac0338","status":"passed","time":{"start":1716600471642,"stop":1716600616685,"duration":145043}},{"uid":"1de5f96388fc729f","reportUrl":"../1898//#testresult/1de5f96388fc729f","status":"passed","time":{"start":1716514538603,"stop":1716514672592,"duration":133989}},{"uid":"65221f3c67e12f9b","reportUrl":"../1896//#testresult/65221f3c67e12f9b","status":"passed","time":{"start":1716428215884,"stop":1716428339085,"duration":123201}},{"uid":"fca763191d8898f4","reportUrl":"../1894//#testresult/fca763191d8898f4","status":"passed","time":{"start":1716341499795,"stop":1716341620373,"duration":120578}},{"uid":"5509b56c395cf5d8","reportUrl":"../1890//#testresult/5509b56c395cf5d8","status":"passed","time":{"start":1716254929364,"stop":1716255056261,"duration":126897}},{"uid":"e68fe2a15cd62e17","reportUrl":"../1889//#testresult/e68fe2a15cd62e17","status":"passed","time":{"start":1716168498304,"stop":1716168621970,"duration":123666}},{"uid":"764f7390e5942572","reportUrl":"../1888//#testresult/764f7390e5942572","status":"passed","time":{"start":1716082074491,"stop":1716082195808,"duration":121317}},{"uid":"ed257ac0a8d3f171","reportUrl":"../1887//#testresult/ed257ac0a8d3f171","status":"passed","time":{"start":1715995683647,"stop":1715995816826,"duration":133179}},{"uid":"29132e3ed443acf5","reportUrl":"../1885//#testresult/29132e3ed443acf5","status":"passed","time":{"start":1715909351001,"stop":1715909476947,"duration":125946}},{"uid":"5a91b603533d73e4","reportUrl":"../1884//#testresult/5a91b603533d73e4","status":"passed","time":{"start":1715822861276,"stop":1715822982609,"duration":121333}},{"uid":"5db6b58098bbbb24","reportUrl":"../1881//#testresult/5db6b58098bbbb24","status":"passed","time":{"start":1715736488224,"stop":1715736616648,"duration":128424}},{"uid":"679a197754f56703","reportUrl":"../1879//#testresult/679a197754f56703","status":"passed","time":{"start":1715650128026,"stop":1715650252459,"duration":124433}},{"uid":"7a42a0365a50c8ca","reportUrl":"../1876//#testresult/7a42a0365a50c8ca","status":"passed","time":{"start":1715563702086,"stop":1715563823267,"duration":121181}},{"uid":"5701f23c3859f6d0","reportUrl":"../1875//#testresult/5701f23c3859f6d0","status":"passed","time":{"start":1715477309445,"stop":1715477436426,"duration":126981}},{"uid":"b947df6e577f07ff","reportUrl":"../1874//#testresult/b947df6e577f07ff","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\nmysql-k8s/0 [idle] waiting: waiting to get cluster primary from peers\n  mysql-k8s/1 [idle] waiting: waiting to get cluster primary from peers\n  mysql-k8s/2 [executing] active: Primary","time":{"start":1715390890454,"stop":1715391899452,"duration":1008998}},{"uid":"aaa5fc40f1c43e02","reportUrl":"../1873//#testresult/aaa5fc40f1c43e02","status":"passed","time":{"start":1715304559997,"stop":1715304690712,"duration":130715}},{"uid":"9aab9b743fb6fc3f","reportUrl":"../1871//#testresult/9aab9b743fb6fc3f","status":"passed","time":{"start":1715218055454,"stop":1715218183505,"duration":128051}},{"uid":"92c5b45557a6337e","reportUrl":"../1869//#testresult/92c5b45557a6337e","status":"passed","time":{"start":1715131369495,"stop":1715131491918,"duration":122423}}]},"tags":["skip_if_deployed","asyncio","abort_on_fail","group(1)"]},"source":"b19cc6413905f379.json","parameterValues":[]}