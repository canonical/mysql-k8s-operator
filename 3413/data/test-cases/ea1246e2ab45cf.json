{"uid":"ea1246e2ab45cf","name":"test_upgrade_from_edge","fullName":"tests.integration.high_availability.test_async_replication_upgrade#test_upgrade_from_edge","historyId":"d79fc3a887248243c4518ea12eaedfd1","time":{"start":1762239391869,"stop":1762239397038,"duration":5169},"description":"Upgrade the two MySQL clusters.","descriptionHtml":"<p>Upgrade the two MySQL clusters.</p>\n","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 8: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 209, in test_upgrade_from_edge\n    run_pre_upgrade_checks(model_1, MYSQL_APP_1)\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 263, in run_pre_upgrade_checks\n    task = juju.run(unit=app_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 8: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"juju","time":{"start":1762238386484,"stop":1762238386757,"duration":273},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"charm","time":{"start":1762238386484,"stop":1762238386484,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model","time":{"start":1762238386757,"stop":1762238386992,"duration":235},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model","time":{"start":1762238386757,"stop":1762238386757,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1762239382720,"stop":1762239382720,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"continuous_writes","time":{"start":1762239382720,"stop":1762239391868,"duration":9148},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Upgrade the two MySQL clusters.","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 8: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 209, in test_upgrade_from_edge\n    run_pre_upgrade_checks(model_1, MYSQL_APP_1)\n  File \"/root/spread_project/tests/integration/high_availability/test_async_replication_upgrade.py\", line 263, in run_pre_upgrade_checks\n    task = juju.run(unit=app_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 8: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","steps":[],"attachments":[{"uid":"596cb009401aa236","name":"log","source":"596cb009401aa236.txt","type":"text/plain","size":1310}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"continuous_writes::0","time":{"start":1762239397040,"stop":1762239398305,"duration":1265},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1762239398305,"stop":1762239398305,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"second_model::0","time":{"start":1762239473309,"stop":1762239598652,"duration":125343},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"first_model::0","time":{"start":1762239598653,"stop":1762239598653,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"juju::0","time":{"start":1762239598654,"stop":1762239598992,"duration":338},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"@pytest.mark.skipif(False, reason='Requires juju 3+')"},{"name":"parentSuite","value":"tests.integration.high_availability"},{"name":"suite","value":"test_async_replication_upgrade"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"18432-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.high_availability.test_async_replication_upgrade"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"87c6754842da4908","status":"unknown","time":{}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":7,"skipped":0,"passed":33,"unknown":0,"total":40},"items":[{"uid":"5d50f5cfdfcb3b27","reportUrl":"../3412//#testresult/5d50f5cfdfcb3b27","status":"passed","time":{"start":1762134245868,"stop":1762134877111,"duration":631243}},{"uid":"8bad78584aca39ab","reportUrl":"../3411//#testresult/8bad78584aca39ab","status":"passed","time":{"start":1762049043807,"stop":1762049639775,"duration":595968}},{"uid":"33b659ba3a43a2f0","reportUrl":"../3410//#testresult/33b659ba3a43a2f0","status":"passed","time":{"start":1761963525383,"stop":1761964239028,"duration":713645}},{"uid":"9f44418635322a4c","reportUrl":"../3409//#testresult/9f44418635322a4c","status":"broken","statusDetails":"TimeoutError: timed out waiting for action, stderr:\nRunning operation 7 with 1 task\n  - task 8 on unit-db1-2\n\nWaiting for task 8...\nERROR timed out waiting for results from: unit db1/2","time":{"start":1761876762306,"stop":1761876823522,"duration":61216}},{"uid":"8b3dc3f4ac881ded","reportUrl":"../3404//#testresult/8b3dc3f4ac881ded","status":"passed","time":{"start":1761828991770,"stop":1761829598403,"duration":606633}},{"uid":"5ab7d2db5fb8a0ad","reportUrl":"../3393//#testresult/5ab7d2db5fb8a0ad","status":"passed","time":{"start":1761702890675,"stop":1761703549846,"duration":659171}},{"uid":"2ac8659de206a157","reportUrl":"../3382//#testresult/2ac8659de206a157","status":"passed","time":{"start":1761616600193,"stop":1761617301899,"duration":701706}},{"uid":"99df6407a38267cf","reportUrl":"../3374//#testresult/99df6407a38267cf","status":"passed","time":{"start":1761531199735,"stop":1761531879262,"duration":679527}},{"uid":"ce50733e855f7eea","reportUrl":"../3373//#testresult/ce50733e855f7eea","status":"passed","time":{"start":1761444107267,"stop":1761444798140,"duration":690873}},{"uid":"2a46867d368c3ec7","reportUrl":"../3372//#testresult/2a46867d368c3ec7","status":"passed","time":{"start":1761357402836,"stop":1761358073537,"duration":670701}},{"uid":"e40272c9a1a794b3","reportUrl":"../3364//#testresult/e40272c9a1a794b3","status":"passed","time":{"start":1761271147877,"stop":1761271820435,"duration":672558}},{"uid":"915561a3ac0772e6","reportUrl":"../3358//#testresult/915561a3ac0772e6","status":"passed","time":{"start":1761184209081,"stop":1761184856900,"duration":647819}},{"uid":"d8d8d9c967c28a41","reportUrl":"../3355//#testresult/d8d8d9c967c28a41","status":"passed","time":{"start":1761104220514,"stop":1761104918866,"duration":698352}},{"uid":"ea98a64f87300507","reportUrl":"../3351//#testresult/ea98a64f87300507","status":"passed","time":{"start":1761012059080,"stop":1761012692440,"duration":633360}},{"uid":"3e187474d8e3d704","reportUrl":"../3344//#testresult/3e187474d8e3d704","status":"passed","time":{"start":1760926277218,"stop":1760926998471,"duration":721253}},{"uid":"14670784bc1a250","reportUrl":"../3343//#testresult/14670784bc1a250","status":"passed","time":{"start":1760838484555,"stop":1760839190314,"duration":705759}},{"uid":"4cda5425c5e55b75","reportUrl":"../3342//#testresult/4cda5425c5e55b75","status":"passed","time":{"start":1760777494256,"stop":1760778216791,"duration":722535}},{"uid":"1dd9ef838838ea5d","reportUrl":"../3338//#testresult/1dd9ef838838ea5d","status":"passed","time":{"start":1760684795078,"stop":1760685520119,"duration":725041}},{"uid":"c7c4064bd80d0b41","reportUrl":"../3336//#testresult/c7c4064bd80d0b41","status":"passed","time":{"start":1760580329106,"stop":1760581008442,"duration":679336}},{"uid":"37d4c2773714df2c","reportUrl":"../3334//#testresult/37d4c2773714df2c","status":"passed","time":{"start":1760493256770,"stop":1760493966949,"duration":710179}}]},"tags":["abort_on_fail","@pytest.mark.skipif(False, reason='Requires juju 3+')"]},"source":"ea1246e2ab45cf.json","parameterValues":[]}