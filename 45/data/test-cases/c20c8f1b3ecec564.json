{"uid":"c20c8f1b3ecec564","name":"test_pre_upgrade_check","fullName":"tests.integration.integration.high_availability.test_upgrade_rollback_incompat#test_pre_upgrade_check","historyId":"4d873f483ea9ffaa7fc17b6ef42f3234","time":{"start":1766800545550,"stop":1766800551456,"duration":5906},"description":"Test that the pre-upgrade-check action runs successfully.","descriptionHtml":"<p>Test that the pre-upgrade-check action runs successfully.</p>\n","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_upgrade_rollback_incompat.py\", line 70, in test_pre_upgrade_check\n    task = juju.run(unit=mysql_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"juju","time":{"start":1766800480037,"stop":1766800480326,"duration":289},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1766800545549,"stop":1766800545549,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test that the pre-upgrade-check action runs successfully.","status":"broken","statusMessage":"jubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/integration/high_availability/test_upgrade_rollback_incompat.py\", line 70, in test_pre_upgrade_check\n    task = juju.run(unit=mysql_leader, action=\"pre-upgrade-check\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_juju.py\", line 1026, in run\n    task.raise_on_failure()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/jubilant_backports/_task.py\", line 120, in raise_on_failure\n    raise TaskError(self)\njubilant_backports._task.TaskError: task error: Task 2: status 'failed', return code 0, details:\nMessage: Pre-upgrade check failed. Cannot upgrade.","steps":[],"attachments":[{"uid":"c29ccffa3597a94f","name":"log","source":"c29ccffa3597a94f.txt","type":"text/plain","size":289}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1766800551458,"stop":1766800551458,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"juju::0","time":{"start":1766801175050,"stop":1766801175283,"duration":233},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"@pytest.mark.skipif(False, reason='Requires amd64 architecture')"},{"name":"parentSuite","value":"tests.integration.integration.high_availability"},{"name":"suite","value":"test_upgrade_rollback_incompat"},{"name":"host","value":"runnervmh13bl"},{"name":"thread","value":"32055-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.integration.high_availability.test_upgrade_rollback_incompat"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"c6425b4bea314435","status":"unknown","time":{}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":19,"unknown":0,"total":20},"items":[{"uid":"f4177997d1ac60b9","reportUrl":"../44//#testresult/f4177997d1ac60b9","status":"passed","time":{"start":1766713628726,"stop":1766713634297,"duration":5571}},{"uid":"bc64cb378583e032","reportUrl":"../43//#testresult/bc64cb378583e032","status":"passed","time":{"start":1766627486514,"stop":1766627492062,"duration":5548}},{"uid":"fbf735da684bf5cb","reportUrl":"../42//#testresult/fbf735da684bf5cb","status":"passed","time":{"start":1766540871714,"stop":1766540877260,"duration":5546}},{"uid":"aa458c1fe5621242","reportUrl":"../41//#testresult/aa458c1fe5621242","status":"passed","time":{"start":1766454265227,"stop":1766454270757,"duration":5530}},{"uid":"6abefec66d8c90a0","reportUrl":"../40//#testresult/6abefec66d8c90a0","status":"passed","time":{"start":1766368205213,"stop":1766368210781,"duration":5568}},{"uid":"24326279d4f9fc3e","reportUrl":"../39//#testresult/24326279d4f9fc3e","status":"passed","time":{"start":1766281744462,"stop":1766281750018,"duration":5556}},{"uid":"20ede31b80ba3d40","reportUrl":"../38//#testresult/20ede31b80ba3d40","status":"passed","time":{"start":1766195187763,"stop":1766195193327,"duration":5564}},{"uid":"e65c52019a9146b9","reportUrl":"../37//#testresult/e65c52019a9146b9","status":"passed","time":{"start":1766110117115,"stop":1766110120932,"duration":3817}},{"uid":"1043648e12484a99","reportUrl":"../36//#testresult/1043648e12484a99","status":"passed","time":{"start":1766022858922,"stop":1766022864458,"duration":5536}},{"uid":"5f04977c43f2cdab","reportUrl":"../35//#testresult/5f04977c43f2cdab","status":"passed","time":{"start":1765936603638,"stop":1765936609164,"duration":5526}},{"uid":"f4981da524e528c3","reportUrl":"../34//#testresult/f4981da524e528c3","status":"passed","time":{"start":1765850399445,"stop":1765850403227,"duration":3782}},{"uid":"80b6d27632259632","reportUrl":"../33//#testresult/80b6d27632259632","status":"passed","time":{"start":1765785460983,"stop":1765785472564,"duration":11581}},{"uid":"a75a2369193cef73","reportUrl":"../31//#testresult/a75a2369193cef73","status":"passed","time":{"start":1765590688053,"stop":1765590693594,"duration":5541}},{"uid":"5f92a1d216cd662","reportUrl":"../30//#testresult/5f92a1d216cd662","status":"passed","time":{"start":1765503992277,"stop":1765503997839,"duration":5562}},{"uid":"5f6cc659bf50311c","reportUrl":"../29//#testresult/5f6cc659bf50311c","status":"passed","time":{"start":1765419104733,"stop":1765419108547,"duration":3814}},{"uid":"cad4ef2e14fd4176","reportUrl":"../26//#testresult/cad4ef2e14fd4176","status":"passed","time":{"start":1765161184724,"stop":1765161196259,"duration":11535}},{"uid":"9a419b0b10244b32","reportUrl":"../25//#testresult/9a419b0b10244b32","status":"passed","time":{"start":1765072984817,"stop":1765072990321,"duration":5504}},{"uid":"f71086d2629d5dbe","reportUrl":"../24//#testresult/f71086d2629d5dbe","status":"passed","time":{"start":1764986578711,"stop":1764986584259,"duration":5548}},{"uid":"8d7953a36f9da996","reportUrl":"../3498//#testresult/8d7953a36f9da996","status":"passed","time":{"start":1764618933643,"stop":1764618937486,"duration":3843}}]},"tags":["abort_on_fail","@pytest.mark.skipif(False, reason='Requires amd64 architecture')"]},"source":"c20c8f1b3ecec564.json","parameterValues":[]}